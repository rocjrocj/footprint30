<!--
	NOTES:
	1. All tokens are represented by '$' sign in the template.curItemMC
	2. You can write your code only wherever mentioned.
	3. All occurrences of existing tokens will be replaced by their appropriate values.
	4. Blank lines will be removed automatically.
	5. Remove unnecessary comments before creating your template.
-->
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="authoring-tool" content="Adobe_Animate_CC">
<title>footprint30</title>
<!-- write your code here -->
<script src="https://use.typekit.net/kiv1woh.js"></script>
<script>try{Typekit.load({ async: true });}catch(e){}</script>
<script src="https://code.createjs.com/createjs-2015.11.26.min.js"></script>
<script src="footprint30.js?1467475395896"></script>
<script src="CanvasInput.min.js"></script>
<link rel="stylesheet" type="text/css" href="style.css">
<script>
var canvas, stage, fp;


/* other vars */
var curItem;
var oldItem;
var curItemMC;
var curScreen;
var moveDir;
var moveTo;
var curFactCardState;
var curMusicState;
var avgLifetime;
var avgTimeframe;
var yourAvg;
var curVidState;
var arrBehindPho;
var curPho;
var phoCount;
var rawJapanAvg;
var rawUSAvg;
var rawWorldAvg;
var rawYourAvg;
var doEnter = false;




function init() {
	canvas = document.getElementById("canvas");
	createjs.MotionGuidePlugin.install();
	images = images||{};
	ss = ss||{};
	var loader = new createjs.LoadQueue(false);
	loader.installPlugin(createjs.Sound);
	loader.addEventListener("fileload", handleFileLoad);
	loader.addEventListener("complete", handleComplete);
	loader.loadManifest(lib.properties.manifest);
}
function handleFileLoad(evt) {	
	if (evt.item.type == "image") { images[evt.item.id] = evt.result; }	
}
function handleComplete(evt) {
	//This function is always called, irrespective of the content. You can use the variable "stage" after it is created in token create_stage.
	var queue = evt.target;
	var ssMetadata = lib.ssMetadata;
	for(i=0; i<ssMetadata.length; i++) {
		ss[ssMetadata[i].name] = new createjs.SpriteSheet( {"images": [queue.getResult(ssMetadata[i].name)], "frames": ssMetadata[i].frames} )
	}
	fp = new lib.footprint30_Scene1();
	stage = new createjs.Stage(canvas);
	stage.addChild(fp);
	stage.enableMouseOver();	
	//Registers the "tick" event listener.
	createjs.Ticker.setFPS(lib.properties.fps);
	createjs.Ticker.addEventListener("tick", tick);	    
	//Code to support hidpi screens and responsive scaling.
	(function(isResp, respDim, isScale, scaleType) {		
		var lastW, lastH, lastS=1;		
		window.addEventListener('resize', resizeCanvas);		
		resizeCanvas();		
		function resizeCanvas() {			
			var w = lib.properties.width, h = lib.properties.height;			
			var iw = window.innerWidth, ih=window.innerHeight;			
			var pRatio = window.devicePixelRatio, xRatio=iw/w, yRatio=ih/h, sRatio=1;			
			if(isResp) {                
				if((respDim=='width'&&lastW==iw) || (respDim=='height'&&lastH==ih)) {                    
					sRatio = lastS;                
				}				
				else if(!isScale) {					
					if(iw<w || ih<h)						
						sRatio = Math.min(xRatio, yRatio);				
				}				
				else if(scaleType==1) {					
					sRatio = Math.min(xRatio, yRatio);				
				}				
				else if(scaleType==2) {					
					sRatio = Math.max(xRatio, yRatio);				
				}			
			}			
			canvas.width = w*pRatio*sRatio;			
			canvas.height = h*pRatio*sRatio;
			canvas.style.width = w*sRatio+'px';			
			canvas.style.height = h*sRatio+'px';
			stage.scaleX = pRatio*sRatio;			
			stage.scaleY = pRatio*sRatio;			
			lastW = iw; lastH = ih; lastS = sRatio;		
		}
	})(false,'both',false,1);
	
	stage.enableMouseOver(10);
	
	var showme = this;
	console.log("this: " + showme);
	
	curItemMC = new createjs.MovieClip(null, 0, false);
	

	// init vars
	curScreen = "intro";
	console.log("curScreen: " + curScreen);
	curItem = 99;
	oldItem = 99;
	moveDir = "move_left";
	moveTo = "question";
	curFactCardState = "off";
	curMusicState = "on";
	avgLifetime = 77.75;
	avgTimeframe = 52;
	// set other text
	//setOtherContent();
	// start audio
	//auIntro.start();
	//auGame.start(0, 999);
	// init intro
	hideAll();
	showIntro()
	showMenu();
	
	// Create and place our text field on the canvas
/*const textField = new TextInput();
textField.y = textField.x = 100;
textField.placeHolder = "Input Field"; // updates the default text
stage.addChild(textField);*/

/*var input = new CanvasInput({
  canvas: document.getElementById('canvas'),
  fontSize: 18,
  fontFamily: 'franklin-gothic-urw',
  fontColor: '#212121',
  fontWeight: 'bold',
  width: 300,
  padding: 8,
  borderWidth: 1,
  borderColor: '#000',
  borderRadius: 3,
  boxShadow: '1px 1px 0px #fff',
  innerShadow: '0px 0px 5px rgba(0, 0, 0, 0.5)',
  placeHolder: 'Enter message here...'
});*/
	
	
	var myInstance1 = createjs.Sound.play("background_loop", {loop:-1});
	 myInstance1.volume = 0.3;
	
	var myInstance2 = createjs.Sound.play("m_intro");
	 myInstance2.volume = 0.2;
	
	fp.mcMenuMoves.mcMenu.butMenuNext.on("click", function(evt) {
		console.log("butMenuNext clicked");
		showMenu();
	});
	

// menu buttons rollovers
fp.mcMenuMoves.mcMenu.butMenuEggs.on("rollover", function(evt) {
		playSound("m_menu_rollover", false);
	});
fp.mcMenuMoves.mcMenu.butMenuNewspapers.on("rollover", function(evt) {
		playSound("m_menu_rollover", false);
	});
fp.mcMenuMoves.mcMenu.butMenuMilks.on("rollover", function(evt) {
		playSound("m_menu_rollover", false);
	});
fp.mcMenuMoves.mcMenu.butMenuCarMiles.on("rollover", function(evt) {
		playSound("m_menu_rollover", false);
	});
fp.mcMenuMoves.mcMenu.butMenuBananas.on("rollover", function(evt) {
		playSound("m_menu_rollover", false);
	});
fp.mcMenuMoves.mcMenu.butMenuSodas.on("rollover", function(evt) {
		playSound("m_menu_rollover", false);
	});
fp.mcMenuMoves.mcMenu.butMenuShowers.on("rollover", function(evt) {
		playSound("m_menu_rollover", false);
	});
fp.mcMenuMoves.mcMenu.butMenuPotatoes.on("rollover", function(evt) {
		playSound("m_menu_rollover", false);
	});
fp.mcMenuMoves.mcMenu.butMenuDiapers.on("rollover", function(evt) {
		playSound("m_menu_rollover", false);
	});
fp.mcMenuMoves.mcMenu.butMenuSlices.on("rollover", function(evt) {
		playSound("m_menu_rollover", false);
	});
		
	

fp.mcMenuMoves.mcMenu.butMenuEggs.on("click", function(evt) {
	menuClick(0, "menu");
	});
fp.mcMenuMoves.mcMenu.butMenuNewspapers.on("click", function(evt) {
	menuClick(1, "menu");
	});
fp.mcMenuMoves.mcMenu.butMenuMilks.on("click", function(evt) {
	menuClick(2, "menu");
	});
fp.mcMenuMoves.mcMenu.butMenuCarMiles.on("click", function(evt) {
	menuClick(3, "menu");
	});
fp.mcMenuMoves.mcMenu.butMenuBananas.on("click", function(evt) {
	menuClick(4, "menu");
	});
fp.mcMenuMoves.mcMenu.butMenuSodas.on("click", function(evt) {
	menuClick(5, "menu");
	});
fp.mcMenuMoves.mcMenu.butMenuShowers.on("click", function(evt) {
	menuClick(6, "menu");
	});
fp.mcMenuMoves.mcMenu.butMenuPotatoes.on("click", function(evt) {
	menuClick(7, "menu");
	});
fp.mcMenuMoves.mcMenu.butMenuDiapers.on("click", function(evt) {
	menuClick(8, "menu");
	});
fp.mcMenuMoves.mcMenu.butMenuSlices.on("click", function(evt) {
	menuClick(9, "menu");
	});
	
		
this.test = function () {
		console.log("test!");
	}
	
fp.mcMenuMoves.butMenu.on("rollover", function(evt) {
	//showMenu();
	});	
fp.mcMenuMoves.butMenu.on("click", function(evt) {
	showMenu();
	});

}
function tick(event) {
	stage.update();
}
function playSound(id, loop) {
	return createjs.Sound.play(id, createjs.Sound.INTERRUPT_EARLY, 0, 0, loop);
}



/*------------------------------------------------------------------------------------------*/


		
function test() {
	console.log("test!");
}

/* intro function */
function showIntro() {
	//setIntroContent();
	fp.mcIntro.visible = true;
	console.log("curScreen: " + curScreen);
}

/* main functions */
function showAnswer() {
	if (yourAvg != -1) {
		showData();
	}
}

function showQuestion() {
	doEnter = true;
	fp.curItemMC = getItem();
	console.log("curItemMC: " + curItemMC);
	fp.curItemMC.visible = true;
	fp.curItemMC.gotoAndPlay("play");
	setQuestionContent();
	fp.mcQuestion.visible = true;
	
	//Selection.setFocus("txtInput");
}

function showQuestionAnswer() {
	doEnter = true;
	curItemMC = getItem();
	curItemMC.gotoAndPlay("play");
	curItemMC.visible = true;
	setQuestionContent();
	mcQuestion.visible = true;
	if (curFactCardState == "off") {
		curFactCardState = "on";
		mcFactCard.gotoAndStop(1);
		mcFactCardMoves.gotoAndStop(1);
		mcFactCardMoves.gotoAndPlay("enter");
	}
	showData(false);
}

/*function showMessages(msg:Number) {
	doEnter = false;
	butEnter.enabled = false;
	xmlNodeHandler = xmlRootHandler[2].childNodes;
	var txtfMessages:TextFormat = new TextFormat();
	txtfMessages.letterSpacing = -.7;
	txtfMessages.kerning = true;
	txtMessages.setNewTextFormat(txtfMessages);
	txtMessages.htmlText = xmlNodeHandler[msg].firstChild.nodeValue;
	mcMessagesMove.gotoAndPlay("enter");
}*/

function hideMessages() {
	if (mcMessagesMove._currentframe == 10) {
		doEnter = true;
		butEnter.enabled = true;
		txtInput.text = "";
		Selection.setFocus("txtInput");
		mcMessagesMove.gotoAndPlay("exit");
	}
}

function menuClickx(item, but) {
	//fp.mcEggs.visible = true;
	hideMenu();
	//if (curItem != item) {
		//hideMessages();
		
		
		console.log("fp.mcEggs.gotoAndStop called");
		//if (curMusicState == "on") {
			//auTransition.start();
		playSound("m_transition", false);
		//}
		//stopVid();
		curScreen = "question";
		//txtInput.text = "";
		//oldItem = curItem;
		//curItem = item;
		if (but == "last") {
			moveDir = "move_left";
		} else if (but == "next") {
			moveDir = "move_right";
		} else {
			if (curItem > oldItem) {
				moveDir = "move_right";
			} else {
				moveDir = "move_left";
			}
		}
		moveEnvironment(moveDir);
		
	//fp.mcEggs.visible = true;
	//fp.mcEggs.gotoAndPlay("play");
	//}
}


function menuClick(item, but) {
	console.log("item: " + item);
	hideMenu();
	if (curItem != item) {
		//hideMessages();
		//fp.curItemMC.gotoAndStop("stop");
		/*if (curMusicState == "on") {
			auTransition.start();
		}
		stopVid();*/
		var auTransition = playSound("m_transition", false);
		auTransition.volume = 0.2;
		curScreen = "question";
		//txtInput.text = "";
		oldItem = curItem;
		curItem = item;
		if (but == "last") {
			moveDir = "move_left";
		} else if (but == "next") {
			moveDir = "move_right";
		} else {
			if (curItem > oldItem) {
				moveDir = "move_right";
			} else {
				moveDir = "move_left";
			}
		}
		moveEnvironment(moveDir);
/*var input = new CanvasInput({
  canvas: document.getElementById('canvas'),
  x: 200,
  y: 200,
  fontSize: 18,
  fontFamily: 'franklin-gothic-urw',
  fontColor: '#212121',
  fontWeight: 'bold',
  width: 300,
  padding: 8,
  borderWidth: 1,
  borderColor: '#000',
  borderRadius: 3,
  boxShadow: '1px 1px 0px #fff',
  innerShadow: '0px 0px 5px rgba(0, 0, 0, 0.5)',
  placeHolder: 'Enter message here...'
});*/
	}
}

//this.showBehind = function() {}
//this.pulse();

this.showBehind = function() {
	doEnter = false;
	// stop music
	//if (curMusicState == "on") {
	//	auGame.stop();
	//}
	//curItemMC.gotoAndStop("stop");
	//setBehindContent();
	fp.mcEggs.visible = true;
	fp.mcEggs.gotoAndPlay("play");
	fp.mcBehind.visible = true;
}

/*function setIntroContent() {
	xmlNodeHandler = xmlRootHandler[0].childNodes;
	var txtfIntroHea:TextFormat = new TextFormat();
	txtfIntroHea.letterSpacing = -1.5;
	txtfIntroHea.kerning = true;
	txtIntroHea.setNewTextFormat(txtfIntroHea);
	txtIntroHea.htmlText = xmlNodeHandler[0].firstChild.nodeValue;
	var txtfIntroTxt:TextFormat = new TextFormat();
	txtfIntroTxt.letterSpacing = -.05;
	txtfIntroTxt.kerning = true;
	txtIntroTxt.setNewTextFormat(txtfIntroTxt);
	txtIntroTxt.htmlText = xmlNodeHandler[1].firstChild.nodeValue;
}*/


function moveEnvironment(dir) {
	hideAll();
	doEnter = false;
	console.log(dir);
	fp.mcCloud1Moves.gotoAndPlay(dir);
	fp.mcCloud2Moves.gotoAndPlay(dir);
	fp.mcGroundMoves.gotoAndPlay(dir);
	fp.mcMountainMoves.gotoAndPlay(dir);
	fp.mcTreesMoves.gotoAndPlay(dir);
	//fp.mcTreesMoves.onAnimationEnd = test();
	console.log("end moveEnviro");
}



function setQuestionContent() {
	//xmlNodeHandler = xmlRootHandler[1].childNodes;
	//xmlNodeHandler2 = xmlNodeHandler[curItem].childNodes;
	//var txtfQuestion:TextFormat = new TextFormat();
	//txtfQuestion.letterSpacing = -1.7;
	//txtfQuestion.kerning = true;
	//txtQuestion.setNewTextFormat(txtfQuestion);
	//txtQuestion.htmlText = xmlNodeHandler2[0].firstChild.nodeValue;
	if (curItem == 0) {
		fp.mcQuestion.txtQuestion.text = "How many eggs do\ryou eat each week?";
	} else if (curItem == 1) {
		fp.mcQuestion.txtQuestion.text = "How many newspapers\rdo you read each week?";
	} else if (curItem == 2) {
		fp.mcQuestion.txtQuestion.text = "How many cups of milk do\ryou drink each week?";
	} else if (curItem == 3) {
		fp.mcQuestion.txtQuestion.text = "How many miles do you\rdrive each day?";
	} else if (curItem == 4) {
		fp.mcQuestion.txtQuestion.text = "How many bananas\rdo you eat each week?";
	} else if (curItem == 5) {
		fp.mcQuestion.txtQuestion.text = "How many cans of soda do\ryou drink each week?";
	} else if (curItem == 6) {
		fp.mcQuestion.txtQuestion.text = "How many showers do\ryou take each week?";
	} else if (curItem == 7) {
		fp.mcQuestion.txtQuestion.text = "How many potatoes do\ryou eat each week?";
	} else if (curItem == 8) {
		fp.mcQuestion.txtQuestion.text = "How many diapers do you think a baby needs each day?";
	} else if (curItem == 9) {
		fp.mcQuestion.txtQuestion.text = "How many slices of bread\rdo you eat each day?";
	}
}



function getItem() {
	if (curItem == 0) {
		return fp.mcEggs;
	} else if (curItem == 1) {
		return fp.mcNewspapers;
	} else if (curItem == 2) {
		return fp.mcMilks;
	} else if (curItem == 3) {
		return fp.mcCarMiles;
	} else if (curItem == 4) {
		return fp.mcBananas;
	} else if (curItem == 5) {
		return fp.mcSodas;
	} else if (curItem == 6) {
		return fp.mcShowers;
	} else if (curItem == 7) {
		return fp.mcPotatoes;
	} else if (curItem == 8) {
		return fp.mcDiapers;
	} else if (curItem == 9) {
		return fp.mcSlices;
	}
}
	//curItemMC.gotoAndStop("stop");
	//mcIntro._visible = false;

function hideAll() {
	//hideMenu();
	fp.mcBehind.visible = false;
	fp.mcData.visible = false;
	fp.mcFactCardMoves.visible = false;
	fp.mcFactCardMoves.gotoAndStop(1);
	fp.curFactCardState = "off";
	//fp.curItemMC.gotoAndStop("stop");
	fp.mcIntro.visible = false;
	fp.mcQuestion.visible = false;
	// items (in menu order)
	fp.mcEggs.visible = false;
	fp.mcNewspapers.visible = false;
	fp.mcMilks.visible = false;
	fp.mcCarMiles.visible = false;
	fp.mcBananas.visible = false;
	fp.mcSodas.visible = false;
	fp.mcShowers.visible = false;
	fp.mcPotatoes.visible = false;
	fp.mcDiapers.visible = false;
	fp.mcSlices.visible = false;
	//fp.mcMenuMoves.visible = false;
	//fp.mcMenuMoves.mcMenu.butMenuLast.visible = false;
	fp.mcMenuMoves.mcMenu.mcMenuLast.visible = false;
	fp.mcMenuMoves.mcMenu.butMenuLast.visible = false;
	fp.mcMenuMoves.mcMenu.mcMenuNext.visible = false;
	fp.mcMenuMoves.mcMenu.butMenuNext.visible = false;
	
}

function hideMenu() {
	if (fp.mcMenuMoves.currentFrame == 14) {
		fp.mcMenuMoves.gotoAndPlay("exit");
	}
	//fp.mcMenuMoves.visible = false;
	console.log("hideMenu");
}

function showMenu() {
	if (fp.mcMenuMoves.currentFrame == 14) {
		fp.mcMenuMoves.gotoAndPlay("exit");
	}
	//fp.mcMenuMoves.visible = true;
	fp.mcMenuMoves.gotoAndPlay("enter");
	console.log("showMenu");
}

</script>
<!-- write your code here -->
</head>
<body onload="init();" style="margin:0px;">
	<div class="dataInput"><input id="setData" type="text"><label>enter</label></div>
	<canvas id="canvas" width="960" height="535" style="display: block; background-color:rgba(142, 228, 255, 1.00)"></canvas>
</body>
</html>